(()=>{"use strict";function e(e){var t=new XMLHttpRequest;return t.open("GET","https://raw.githubusercontent.com/NHSDigital/electronic-prescription-service-api/master/examples/"+e,!1),t.send(null),JSON.parse(t.responseText)}const t={PRIMARY_CARE_ACUTE_NOMINATED:e("primary-care/acute/nominated-pharmacy/medical-prescriber/1-Prepare-Request-200_OK.json"),PRIMARY_CARE_REPEAT_PRESCRIBING_NOMINATED:e("primary-care/repeat-prescribing/1-Prepare-Request-200_OK.json"),SECONDARY_CARE_COMMUNITY_ACUTE_NOMINATED:e("secondary-care/community/acute/nominated-pharmacy/clinical-practitioner/1-Prepare-Request-200_OK.json"),SECONDARY_CARE_COMMUNITY_ACUTE_NON_NOMINATED:e("secondary-care/community/acute/no-nominated-pharmacy/clinical-practitioner/1-Prepare-Request-200_OK.json"),SECONDARY_CARE_REPEAT_DISPENSING_NOMINATED:e("secondary-care/community/repeat-dispensing/nominated-pharmacy/clinical-practitioner/multiple-medication-requests/prescriber-endorsed/1-Prepare-Request-200_OK.json"),SECONDARY_CARE_COMMUNITY_ACUTE_NON_NOMINATED:e("secondary-care/community/acute/no-nominated-pharmacy/clinical-practitioner/1-Prepare-Request-200_OK.json"),SECONDARY_CARE_REPEAT_DISPENSING_NOMINATED:e("secondary-care/community/repeat-dispensing/nominated-pharmacy/clinical-practitioner/multiple-medication-requests/prescriber-endorsed/1-Prepare-Request-200_OK.json"),HOMECARE_ACUTE_NOMINATED:e("secondary-care/homecare/acute/nominated-pharmacy/clinical-practitioner/1-Prepare-Request-200_OK.json")},n={examples:[new r("1","Primary Care - Acute (nominated)",t.PRIMARY_CARE_ACUTE_NOMINATED),new r("3","Primary Care - Repeat Prescribing (nominated)",t.PRIMARY_CARE_REPEAT_PRESCRIBING_NOMINATED),new r("4","Secondary Care - Acute (nominated)",t.SECONDARY_CARE_COMMUNITY_ACUTE_NOMINATED),new r("5","Secondary Care - Acute",t.SECONDARY_CARE_COMMUNITY_ACUTE_NON_NOMINATED),new r("8","Homecare - Acute (nominated)",t.HOMECARE_ACUTE_NOMINATED),new r("custom","Custom",null)],releases:[new i("all","All nominated"),new i("custom","Custom")],pharmacies:[new s("VNFKT","FIVE STAR HOMECARE LEEDS LTD"),new s("YGM1E","MBBM HEALTHCARE TECHNOLOGIES LTD"),new s("custom","Custom",null)],actions:[new o("",""),new o("cancel","Cancel")],reasons:[new a("0001","Prescribing Error"),new a("0002","Clinical contra-indication"),new a("0003","Change to medication treatment regime"),new a("0004","Clinical grounds"),new a("0005","At the Patient's request"),new a("0006","At the Pharmacist's request"),new a("0007","Notification of Death"),new a("0008","Patient deducted - other reason"),new a("0009","Patient deducted - registered with new practice")],cancellers:[new c("same-as-original-author","","Use original author","","","","","","",""),new c("R8006","Admin","Medical Secetary Access Role","212304192555","555086718101","https://fhir.hl7.org.uk/Id/professional-code","unknown","MS","Medical","Secetary")],environment:"prod",mode:"home",signature:"",loggedIn:"true"===Cookies.get("Access-Token-Set"),showCustomExampleInput:!1,showCustomPharmacyInput:!1,selectedExampleId:"1",selectedCancellationReasonId:"0001",selectedCancellerId:"same-as-original-author",selectedReleaseId:"all",prescriptionId:new URLSearchParams(window.location.search).get("prescription_id"),payloads:[]};function r(e,t,r){this.id=e,this.description=t,this.message=r,this.select=function(){n.selectedExampleId=e,n.showCustomExampleInput="custom"===e,l(n.mode)}}function s(e,t){this.id=e,this.name=t,this.display="custom"===e?"Custom":this.id+" - "+this.name,this.select=function(){n.selectedPharmacy=e,n.showCustomPharmacyInput="custom"===e,l(n.mode)}}function i(e,t){this.id=e,this.description=t,this.select=function(){n.selectedReleaseId=e,n.showCustomPrescriptionIdInput="custom"===e,l(n.mode)}}function o(e,t){this.id=e,this.description=t}function a(e,t){this.id=e,this.display=t,this.select=function(){n.selectedCancellationReasonId=e,l(n.mode)}}function c(e,t,r,s,i,o,a,c,u,d){this.id=e,this.type=t,this.display=r,this.sdsRoleProfileId=s,this.sdsUserId=i,this.professionalCodeSystem=o,this.professionalCodeValue=a,this.title=c,this.firstName=u,this.lastName=d,this.description="same-as-original-author"===e?r:`${t} - ${r}`,this.select=function(){n.selectedCancellerId=e,l(n.mode)}}function u(e){return e.filter(Boolean).reduce((function(e,t){return e.concat(t)}),[])}function d(e){return e?e.map((function(e){return"("+e+")"})):e}function l(e){n.mode=e,n.errorList=null,n.sendResponse=null,n.signResponse=null,n.cancelResponse=null,n.showCustomExampleInput="load"===e&&"custom"===n.selectedExampleId,n.showCustomPharmacyInput=("edit"===e||"release"===e)&&"custom"===n.selectedPharmacy,n.showCustomPrescriptionIdInput="release"===e&&"custom"===n.selectedReleaseId,n.releaseResponse=null,n.dispenseResponse=null,n.selectedPharmacy="edit"===e||"release"===e?n.selectedPharmacy??"VNFKT":null,"sign"==n.mode&&(n.previous_prescription_id=Cookies.get("Previous-Prescription-Id"),n.next_prescription_id=Cookies.get("Next-Prescription-Id"))}"prod"!==n.environment&&(n.actions.push(new o("release","Release")),n.actions.push(new o("dispense","Dispense"))),rivets.formatters.snomedCode={read:function(e){return e.length?e.filter((function(e){return"http://snomed.info/sct"===e.system}))[0].code:""},publish:function(e,t){return t}},rivets.formatters.snomedCodeDescription={read:function(e){return e.length?e.filter((function(e){return"http://snomed.info/sct"===e.system}))[0].display:""},publish:function(e,t){return t}},rivets.formatters.prescriptionEndorsements=function(e){return e?e.filter((e=>"https://fhir.nhs.uk/StructureDefinition/Extension-DM-PrescriptionEndorsement"===e.url)).flatMap((e=>e.valueCodeableConcept.coding)).map((e=>e.code)).join(", "):""},rivets.formatters.nhsNumber=function(e){if(!e)return"";const t=e.filter((function(e){return"https://fhir.nhs.uk/Id/nhs-number"===e.system}))[0].value;return t.substring(0,3)+" "+t.substring(3,6)+" "+t.substring(6)},rivets.formatters.odsCode=function(e){return e?e.filter((function(e){return"https://fhir.nhs.uk/Id/ods-organization-code"===e.system}))[0].value:""},rivets.formatters.titleCase=function(e){return e?e.substring(0,1).toUpperCase()+e.substring(1):""},rivets.formatters.dosageInstruction=function(e){return e?e[0].text:""},rivets.formatters.dispenserNotes=function(e){return e?.filter((e=>e.text)).map((e=>e.text)).join(". ")},rivets.formatters.fullName=function(e){return e?u([(t=e.family,t?t.toUpperCase():t),e.given,d(e.prefix),d(e.suffix)]):"";var t},rivets.formatters.fullAddress=function(e){return u([e.line,e.city,e.district,e.state,e.postalCode,e.country])},rivets.formatters.isProd=function(e){return"prod"===e},rivets.formatters.isLogin=function(e){return"login"===e},rivets.formatters.isHome=function(e){return"home"===e},rivets.formatters.isLoad=function(e){return"load"===e},rivets.formatters.isEdit=function(e){return"edit"===e},rivets.formatters.isSign=function(e){return"sign"===e},rivets.formatters.isVerify=function(e){return"verify"===e},rivets.formatters.isSend=function(e){return"send"===e},rivets.formatters.isCancel=function(e){return"cancel"===e},rivets.formatters.isRelease=function(e){return"release"===e},rivets.formatters.isDispense=function(e){return"dispense"===e},rivets.formatters.showPharmacyList=function(e){return"edit"===e||"release"===e},rivets.formatters.joinWithSpaces=function(e){return e.join(" ")},rivets.formatters.appendPageMode=function(e){return e+n.mode},rivets.formatters.displayEnvironment=function(e){return"prod"===e?"Production":"int"===e?"Integration":e},window.onerror=function(e,t,r,s,i){return"cancel"===n.mode&&"Uncaught TypeError: Cannot read property 'length' of undefined"===e||(o="Unhandled error: "+e+" at "+t+":"+r+" col "+s,void 0!==n.errorList&&null!==n.errorList||(n.errorList=[]),n.errorList.push({message:o})),!0;var o}})();